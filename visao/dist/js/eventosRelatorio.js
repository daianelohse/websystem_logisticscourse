function dataRelatorio(a){var t=new Date,i=t.getMonth()-1,o=t.getFullYear();6>=i?($("#dataInicio"+a).val("01/01/"+o),$("#dataFim"+a).val("30/06/"+o)):i>6&&($("#dataInicio"+a).val("01/07/"+o),$("#dataFim"+a).val("31/12/"+o))}function abrirModalRelatorioTurma(a,t){modalAberto=1,$.ajax({type:"GET",data:{id:a,nome:t},url:"modalRelatorioTurma.php"}).done(function(a){$("#modalRelatorioTurma").html(a),dataRelatorio("Turma"),$(".datepicker").datepicker({format:"dd/mm/yyyy",language:"pt-BR"})}).fail(function(){$("#modalRelatorioTurma").html("<div class='alert alert-danger'>Desculpe, ocorreu um erro.</div>")})}function abrirModalRelatorioAluno(a,t,i){this.turma=t,modalAberto=2,$.ajax({type:"GET",data:{id:a,nome:i},url:"modalRelatorioAluno.php"}).done(function(a){$("#modalRelatorioAluno").html(a),dataRelatorio("Aluno"),$(".datepicker").datepicker({format:"dd/mm/yyyy",language:"pt-BR"})}).fail(function(){$("#modalRelatorioAluno").html("<div class='alert alert-danger'>Desculpe, ocorreu um erro.</div>")})}function preparaData(){dataInicio=dataInicio.getDate()+"/"+(dataInicio.getMonth()+1)+"/"+dataInicio.getFullYear(),dataFim=dataFim.getDate()+"/"+(dataFim.getMonth()+1)+"/"+dataFim.getFullYear()}function gerarRelatorio(){if(limpaMensagem("dataInicio"),limpaMensagem("dataFim"),$("#relatorioTurma-alert").hide().html(""),$("#relatorioAluno-alert").hide().html(""),1==modalAberto){$("#statusTurma").show().html("Carregando...");var a=$("#dataInicioTurma").val(),t=$("#dataFimTurma").val()}else{$("#statusAluno").show().html("Carregando...");var a=$("#dataInicioAluno").val(),t=$("#dataFimAluno").val()}for(var i=new Array,o=new Array,e=0;3>e;e++){var r=a,n=t;0==e?(i[e]=r.substring(e,e+2),o[e]=n.substring(e,e+2)):(i[e]=r.substring(3*e,5*e),o[e]=n.substring(3*e,5*e))}dataInicio=new Date(i[2],i[1]-1,i[0]),dataFim=new Date(o[2],o[1]-1,o[0]);var l;l=1==modalAberto?$("#idTurma").val():$("#idAluno").val(),""==a&&""==t?(mensagem("dataInicio","'data início' está vazio"),mensagem("dataFim","'data fim' está vazio")):""==dataInicio||"undefined"==dataInicio?mensagem("dataInicio","'data início' está vazio"):""==dataFim||"undefined"==dataFim?mensagem("dataFim","'data fim' está vazio"):dataInicio>dataFim?1==modalAberto?($("#relatorioTurma-alert").show().html("<span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Data Inválida<br />"),$("#statusTurma").hide().html("")):($("#relatorioAluno-alert").show().html("<span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Data Inválida<br />"),$("#statusAluno").hide().html("")):(preparaData(),1==modalAberto?$.ajax({type:"GET",data:{url:"verificarResultadosRelatorioTurma",id:l,data_inicio:dataInicio,data_fim:dataFim},url:"funcoesControle.php"}).done(function(a){"sucesso"!==a?($("#relatorioTurma-alert").css("display","inline"),$("#relatorioTurma-alert").html("<span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Nenhum resultado encontrado durante o período informado.<br />"),$("#statusTurma").hide().html("")):"sucesso"==a&&($("#statusTurma").show().html("<span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Se nenhuma janela for aberta dinâmicamente com o pdf gerado, <a href='relatorioTurma.php?id="+l+"&dataInicio="+dataInicio+"&dataFim="+dataFim+"' target='_blank'>clique aqui </a>."),window.open("relatorioTurma.php?id="+l+"&dataInicio="+dataInicio+"&dataFim="+dataFim,"_blank"))}).fail(function(){$("#modalRelatorioAluno").html("<div class='alert alert-danger'>Desculpe, ocorreu um erro ao verificar datas.</div>"),preparaLink(),$("#geraRelatorioTurma").attr("href","relatorioTurma.php?id="+l+"&dataInicio="+dataInicio+"&dataFim="+dataFim)}):($.ajax({type:"GET",data:{url:"verificarResultadosRelatorioAluno",id:l,turma:turma,data_inicio:dataInicio,data_fim:dataFim},url:"funcoesControle.php"}).done(function(a){"sucesso"!==a?($("#relatorioAluno-alert").css("display","inline"),$("#relatorioAluno-alert").html("<span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Nenhum resultado encontrado durante o período informado.<br />"),$("#statusAluno").hide().html("")):($("#statusAluno").show().html("<span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Se nenhuma janela for aberta dinâmicamente com o pdf gerado, <a href='relatorioAluno.php?id="+l+"&turma="+turma+"&dataInicio="+dataInicio+"&dataFim="+dataFim+"' target='_blank'>clique aqui</a>."),window.open("relatorioAluno.php?id="+l+"&turma="+turma+"&dataInicio="+dataInicio+"&dataFim="+dataFim))}).fail(function(){$("#modalRelatorioAluno").html("<div class='alert alert-danger'>Desculpe, ocorreu um erro ao verificar datas.</div>"),preparaLink(),$("#geraRelatorioAluno").attr("href","relatorioAluno.php?id="+l+"&turma="+turma+"&dataInicio="+dataInicio+"&dataFim="+dataFim)}),$("#statusAluno").hide().html("")))}var modalAberto=0,turma;