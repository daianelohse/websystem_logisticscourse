function atualizarTurmas(){$("#breadPlanoDeAula").length>0&&$("#planoDeAula").hide(),$("#turmas").show(),$("#alunos").hide(),$(".breadcrumb").html('<li><a href="#" class="active" onclick="atualizarTurmas()">Turmas</a></li>'),1==tipoUser?$.ajax({type:"GET",url:"funcoesControle.php?url=pegarTurmas"}).done(function(a){$("#listaTurmas").html(a)}).fail(function(){$("#listaTurmas").html("<div id='alert' class='alert col-sm-12 alert-danger'>\n    <span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Erro ao carregar as turmas, tente novamente. Se o erro persistir, consulte o administrador.</div>")}):$.ajax({type:"GET",url:"funcoesControle.php?url=pegarTurmasDoProfessor&id="+professorLogado}).done(function(a){""!==a&&$("#listaTurmas").html(a)})}function cadastrarNovaTurma(){validar()&&($("#addTurma-alert").show().html('<div id="alerta" class="alert alert-info"><i class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></i> Salvando...'),limpaMensagem("selectProfessores"),limpaMensagem("turma"),limpaMensagem("selectProfessores"),turmaCadastro=$("#turma").val(),isNaN(turmaCadastro)||turmaCadastro.toUpperCase(),professor=1==tipoUser?professoresSelecionados:professorLogado,eNovaTurma=!0,""!==$("#turma").val()?$.ajax({type:"POST",data:{turma:turmaCadastro.toUpperCase(),professor:professor},url:"funcoesControle.php?url=cadastrarTurma"}).done(function(a){$("#addTurma-alert").html(a),setTimeout(function(){$("#addTurma-alert").html("")},3e3),$("#alerta").hasClass("alert-success")&&($("#turma").val(""),atualizarTurmas(),abrirCadastroTurmas(tipoUser))}).fail(function(){$("#addTurma-alert").html(""),$("#addTurma-alert").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Erro ao cadastrar</div>")}):2==tipoUser&&""!=$("#selectTurmas").val()&&(idTurma=$("#selectTurmas").val(),nomeTurma=$("#selectTurmas option:selected").html(),$.ajax({type:"POST",data:{idTurma:idTurma,nomeTurma:nomeTurma,idProfessor:professor},url:"funcoesControle.php?url=cadastrarTurmaProfessor"}).done(function(a){$("#addTurma-alert").html(a),setTimeout(function(){$("#addTurma-alert").html("")},3e3),$("#alerta").hasClass("alert-success")&&($("#turma").val(""),atualizarTurmas(),abrirCadastroTurmas(tipoUser))}).fail(function(){$("#addTurma-alert").html(""),$("#addTurma-alert").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Erro ao cadastrar</div>")})))}function validar(){var a=0,r=0,e=!1;$("#addTurma-alert").html(""),limpaMensagem("turma"),limpaMensagem("selectProfessores"),limpaMensagem("selectTurmas");var s=$("#turma").val();""==s||edicao?(a++,r++):$.ajax({type:"GET",async:!1,data:{nomeTurma:s},url:"funcoesControle.php?url=validarNomeTurma",beforeSend:function(){a++}}).done(function(a){""!=a&&(mensagem("turma",a),e=!0),r++}).fail(function(){$("#addTurma-alert").html("<div id='alert' class='alert col-sm-12 alert-danger'>\n    <span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Erro ao carregar as turmas, tente novamente. Se o erro persistir, consulte o administrador.</div>")}),""==$("#turma").val()&&""==$("#selectTurmas").val()&&(e=!0),2==tipoUser&&""!==$("#turma").val()&&""!==$("#selectTurmas").val()&&$("#selectTurmas option").size()>0&&($("#addTurma-alert").html("<div class='alert alert-danger'><i class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></i>Os dois campos não devem estar preenchidos simultâneamente</div>"),e=!0);var o;if(1!==tipoUser&&(o=professorLogado),1==tipoUser){if(!(professoresSelecionados.length>0))return mensagem("selectProfessores","Selecione um professor!"),e=!0,!1;limpaMensagem("selectProfessores")}return 1===a&&1===r?e?!1:!0:void 0}function abrirCadastroTurmas(){1==tipoUser&&pegarProfessoresCadastro(),$("#adicionarTurma").show(),$("#salvarTurma").show(),$("#editarTurma").hide(),$("#turma").val(""),$("#labelTurma").html("Nova Turma"),professor=1==tipoUser?professoresSelecionados:professorLogado,$.ajax({type:"GET",url:"funcoesControle.php?url=pegarTurmasSelect"}).done(function(a){$("#selectTurmas").html(a),""==!a?($("#selectTurmas").show(),$("#labelTurmasSemEsteProfessor").show()):($("#selectTurmas").hide(),$("#labelTurmasSemEsteProfessor").hide())}).fail(function(){alert("Ocorreu ao carregar as turmas")})}function pegarProfessoresCadastro(){$(".token-input-list").remove(),$("#cadastrarTurma").tokenInput("funcoesControle.php?url=pegarprofessoresPesquisa",{propertyToSearch:"nome_professor",searchingText:"Pesquisando...",hintText:"Pesquise o nome de um professor...",noResultsText:"Nenhum professor encontrado",resultsFormatter:function(a){return"<li><div id='pesquisaProfessores' class='glyphicon glyphicon-user' title='"+a.nome_professor+"'></div><div style='display: inline-block; padding-left: 10px;'><div class='full_name'>"+a.nome_professor+"</div><div class='email'>"+a.email_usuario+"</div></div></li>"},tokenFormatter:function(a){return"<span id='professorSelecionado'>"+a.nome_professor+"</span>"},onAdd:function(a){return professoresSelecionados.indexOf(a.id_professor)>-1?!1:void professoresSelecionados.push(a.id_professor)},onDelete:function(a){var r=professoresSelecionados.indexOf(a.id_professor);r>-1&&professoresSelecionados.splice(r,1)},onReady:function(){professoresSelecionados=null,professoresSelecionados=new Array}})}function pegarProfessoresEdicao(a){if(professoresSelecionados=new Array,null!=a){var r=null;$.ajax({async:!1,type:"GET",url:"funcoesControle.php?url=pegarProfessoresByIdTurma&id="+a}).done(function(a){r="["+a+"]",r=JSON.parse(r)})}else r=null;$("#cadastrarTurma").tokenInput("funcoesControle.php?url=pegarprofessoresPesquisa",{propertyToSearch:"nome_professor",searchingText:"Pesquisando...",hintText:"Pesquise o nome de um professor...",noResultsText:"Nenhum professor encontrado",prePopulate:r,resultsFormatter:function(a){return"<li><div id='pesquisaProfessores' class='glyphicon glyphicon-user' title='"+a.nome_professor+"'></div><div style='display: inline-block; padding-left: 10px;'><div class='full_name'>"+a.nome_professor+"</div><div class='email'>"+a.email_usuario+"</div></div></li>"},tokenFormatter:function(a){return professoresSelecionados.indexOf(a.id_professor)>-1?!1:(professoresSelecionados.push(a.id_professor),"<span id='professorSelecionado'>"+a.nome_professor+"</span>")},onAdd:function(a){return professoresSelecionados.indexOf(a.id_professor)>-1?!1:void professoresSelecionados.push(a.id_professor)},onDelete:function(a){var r=professoresSelecionados.indexOf(a.id_professor);r>-1&&professoresSelecionados.splice(r,1)}})}function editarTurma(a,r){edicao=!0,idTurmaEdicao=a,$("#inputProfessor ul:first-child").remove(),pegarProfessoresEdicao(a),$("#adicionarTurma").show(),$("#salvarTurma").hide(),$("#editarTurma").show(),$("#turma").val(r),$("#labelSelectTurma").hide(),$("#labelTurma").html("Editar Nome"),$("#selectTurmas").hide()}function salvarEdicaoTurma(){validar()&&($("#addTurma-alert").show().html('<div id="alerta" class="alert alert-info"><i class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></i> Salvando alterações...'),limpaMensagem("selectProfessores"),limpaMensagem("turma"),limpaMensagem("selectProfessores"),turmaCadastro=$("#turma").val(),professor=1==tipoUser?professoresSelecionados:professorLogado,$.ajax({type:"POST",data:{idTurma:idTurmaEdicao,nomeTurma:turmaCadastro.toUpperCase(),idProfessor:professor},url:"funcoesControle.php?url=editarTurma"}).done(function(a){$("#addTurma-alert").html(a),setTimeout(function(){$("#addTurma-alert").html("")},3e3),$("#alerta").hasClass("alert-success")&&($("#turma").val(""),atualizarTurmas(),abrirCadastroTurmas(tipoUser))}).fail(function(){$("#addTurma-alert").html(""),$("#addTurma-alert").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Erro ao cadastrar</div>")}))}function arquivarTurma(a,r){$.ajax({type:"GET",data:{id:a,nome:r},url:"modalArquivarTurma.php"}).done(function(a){$("#modalArquivarTurma").html(a)}).fail(function(){$("#modalArquivarTurma").html("<div class='alert alert-danger'>Desculpe, ocorreu um erro.</div>")})}function confirmarArquivarTurma(a){$("#arquivarTurma-alert").show().html('<div id="alerta" class="alert alert-info"><i class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></i> Arquivando...'),$.ajax({type:"POST",data:{id:a},url:"funcoesControle.php?url=arquivarTurma"}).done(function(a){$("#arquivarTurma-alert").html(a),$("#alerta").hasClass("alert-success")&&$(".botoesModalConfirmacao").hide(),setTimeout(function(){$("#alerta").hasClass("alert-success")&&(atualizarTurmas(),atualizarNumeroTurmasArquivadas(),atualizarTurmasArquivadas(),$(".modalArquivarTurma").modal("hide")),$("#arquivarTurma-alert").html("")},2e3)}).fail(function(){$("#arquivarTurma-alert").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Ocorreu um erro ao arquivar turma.</div>"),setTimeout(function(){$("#arquivarTurma-alert").html("")},3e3)})}function atualizarNumeroTurmasArquivadas(){1==tipoUser?$.ajax({type:"GET",url:"funcoesControle.php?url=numeroTurmasArquivadas"}).done(function(a){$("#nTurmasArquivadas").html(a)}).fail(function(){$("#nTurmasArquivadas").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Ocorreu um erro ao atualizar o número de turmas arquivadas.</div>"),setTimeout(function(){$("#nTurmasArquivadas").html("")},3e3)}):$.ajax({type:"GET",data:{id:professorLogado},url:"funcoesControle.php?url=numeroTurmasArquivadasByIdProfessor"}).done(function(a){$("#nTurmasArquivadas").html(a)}).fail(function(){$("#nTurmasArquivadas").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Ocorreu um erro ao atualizar o número de turmas arquivadas.</div>"),setTimeout(function(){$("#nTurmasArquivadas").html("")},3e3)})}function abrirTurmasArquivadas(){$("#nTurmasArquivadas").hide(),$("#iconCollapseTurmasArquivadas").removeClass("glyphicon-collapse-down"),$("#iconCollapseTurmasArquivadas").addClass("glyphicon-collapse-up"),$("#lstTurmasArquivadas").show(),atualizarTurmasArquivadas()}function atualizarTurmasArquivadas(){1==tipoUser&&$.ajax({type:"GET",url:"funcoesControle.php?url=pegarTurmasArquivadas"}).done(function(a){$("#lstTurmasArquivadas").html(a)}).fail(function(){$("#lstTurmasArquivadas").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Ocorreu um erro ao carregar as turmas arquivadas.</div>"),setTimeout(function(){$("#lstTurmasArquivadas").html("")},3e3)}),2==tipoUser&&$.ajax({type:"GET",data:{id:professorLogado},url:"funcoesControle.php?url=pegarTurmasArquivadasByIdProfessor"}).done(function(a){$("#lstTurmasArquivadas").html(a)}).fail(function(){$("#lstTurmasArquivadas").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Ocorreu um erro ao carregar as turmas arquivadas.</div>"),setTimeout(function(){$("#lstTurmasArquivadas").html("")},3e3)})}function fecharTurmasArquivadas(){$("#nTurmasArquivadas").show(),$("#lstTurmasArquivadas").hide(),$("#iconCollapseTurmasArquivadas").removeClass("glyphicon-collapse-up"),$("#iconCollapseTurmasArquivadas").addClass("glyphicon-collapse-down")}function collapseTurmas(){$("#iconCollapseTurmasArquivadas").hasClass("glyphicon-collapse-up")?fecharTurmasArquivadas():$("#iconCollapseTurmasArquivadas").hasClass("glyphicon-collapse-down")&&abrirTurmasArquivadas()}function abrirTurmaFechada(a,r){$.ajax({type:"GET",data:{id:a,nome:r},url:"modalAbrirTurma.php"}).done(function(a){$("#modalAbrirTurma").html(a)}).fail(function(){$("#modalAbrirTurma").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Ocorreu um erro ao carregar as turmas arquivadas.</div>"),setTimeout(function(){$("#modalAbrirTurma").html("")},3e3)})}function confirmarAbrirTurmaArquivada(a){$("#abrirTurma-alert").show().html('<div id="alerta" class="alert alert-info"><i class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></i> Salvando alterações...'),$.ajax({type:"POST",data:{id:a},url:"funcoesControle.php?url=abrirTurmaArquivada"}).done(function(a){$("#abrirTurma-alert").show(),$("#abrirTurma-alert").html(a),$("#alerta").hasClass("alert-success")&&$(".botoesModalConfirmacao").hide(),setTimeout(function(){$("#alerta").hasClass("alert-success")&&(atualizarTurmas(),abrirTurmasArquivadas(),atualizarNumeroTurmasArquivadas(),$("#abrirTurma-alert").hide(),$(".modalAbrirTurma").modal("hide")),$("#abrirTurma-alert").html("")},2e3)}).fail(function(){$("#abrirTurma-alert").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Ocorreu um erro ao abrir turma.</div>"),setTimeout(function(){$("#abrirTurma-alert").html("")},3e3)})}function excluirTurma(a,r){$.ajax({type:"GET",data:{id:a,nome:r},url:"modalExcluirTurma.php"}).done(function(a){$("#modalExcluirTurma").html(a)}).fail(function(){$("#modalExcluirTurma").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Ocorreu um erro ao excluir turma.</div>"),setTimeout(function(){$("#modalExcluirTurma").html("")},3e3)})}function confirmarExcluirTurma(a){$("#excluirTurma-alert").show().html('<div id="alerta" class="alert alert-info"><i class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></i> Removendo...'),$.ajax({type:"POST",data:{id:a},url:"funcoesControle.php?url=excluirTurma"}).done(function(a){$("#excluirTurma-alert").show(),$("#excluirTurma-alert").html(a),$("#alerta").hasClass("alert-success")&&$(".botoesModalConfirmacao").hide(),setTimeout(function(){$("#alerta").hasClass("alert-success")&&(atualizarTurmasArquivadas(),atualizarNumeroTurmasArquivadas(),$("#excluirTurma-alert").hide(),$(".modalExcluirTurma").modal("hide")),$("#excluirTurma-alert").html("")},2e3)}).fail(function(){$("#excluirTurma-alert").html("<div id='alert' class='alert col-sm-12 alert-danger'><span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span> Ocorreu um erro ao abrir turma.</div>"),setTimeout(function(){$("#excluirTurma-alert").html("")},3e3)})}var erroCadastroTurma=!1,nomeTurma=null,turmaCadastro=null,professoresSelecionados,idTurmaEdicao,edicao=!1;$(function(){atualizarNumeroTurmasArquivadas()});